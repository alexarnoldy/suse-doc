<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<?asciidoc-toc?>
<?asciidoc-numbered?>

<book lang="en">
<bookinfo>
    <title>Reference Configuration : HPE Helion OpenStack 8 with HPE ProLiant</title>
    <author>
        <firstname>Bryan Gartner, SUSE &lt; Bryan.Gartner@SUSE.com &gt;</firstname>
    </author>
    <authorinitials>{</authorinitials>
</bookinfo>
<chapter id="_executive_summary">
<title>Executive Summary</title>
<simpara>This reference configuration white paper is intended to help an organization create and deploy an on-premise private cloud infrastructre used to deploy, orchestrate and manage application workloads.</simpara>
<simpara>For most enterprise-level businesses, the demand for an on-premise, multi-tenancy private cloud is increasing rapidly, allowing the hosting of both production and other phases of workloads, whether bare-metal, virtualized or containerized. This approach may compliment an existing public cloud strategy of a business or even help reduce the financial impact and improve security aspects of data and workloads. Such an intelligent, software-defined infrastructure consisting of HPE Helion OpenStack (powered by SUSE&#174;) technology and HPE&#174; ProLiant system hardware enables you to transform your enterprise. It delivers Infrastructure-as-a-Service (IaaS) to reduce costs while still providing flexibility to keep up with your future demands. With this completely tested and certified approach, you will have the confidence to deploy a working solution in an agile manner, and be able to maintain and scale it as needed over time. This document focuses on a new implementation, pointing out design decisions, citing best practices, considerations and recommendations to implement a functional deployment.</simpara>
</chapter>
<chapter id="_target_audience">
<title>Target Audience</title>
<simpara>This document is intended for IT decision makers yet focuses on architects, system administrators and field technicians who are implementing the HPE ProLiant platform and need a flexible, software-defined, Infrastructure-as-a-Service platform. The reader should be familiar with all of the traditional pillars of IT infrastructures&#8201;&#8212;&#8201;networking, computing and storage&#8201;&#8212;&#8201;along with their local use cases for sizing, scaling and limitations within their environments.</simpara>
</chapter>
<chapter id="_solution_overview">
<title>Solution Overview</title>
<simpara>Private cloud delivers access to a pools of processing, storage, networking functionality and other resources over a network. The deployment abstracts the complex, internal infrastructures from end users. It allows individual compute nodes and workloads to be provisioned on demand from predefined templates with little concern about the underlying infrastructure or resources. Services, consisting of many such orchestrated workloads can be provisioned for use in minutes and then scaled appropriately to meet service demands for use by multiple tenants.</simpara>
<note><simpara>As a further reference, the National Institute of Standards and Technology&#8217;s (NIST) <ulink url="https://csrc.nist.gov/publications/detail/sp/800-145/final">Definition of Cloud Computing</ulink> describes the important characteristics of cloud computing.</simpara></note>
<simpara>These resources are integrated through private cloud software to provide the robust foundation for applications and services before adding deployed workloads. Networking is the unifying component tying computing and storage resources together. Given the complexity of such an infrastructure, the network must be fully configurable and adapt to change requests upon demand. High-speed, scalable devices like the HPE FlexFabric series of network switches provide a great foundation. Compute resources are provided via physical nodes or virtual machines running atop a hypervisor. Storage resources can be provided through either dedicated storage elements or distributed, resilient storage solutions. Modern, industry-leading x86-based servers like the HPE ProLiant servers provide an ideal platform for private clouds because they balance performance and efficiency. Finally, it is the private cloud software that provides the user interface for setup, configuration, maintenance, and long term operation of these three core components bonding them into a cohesive service offering.</simpara>
</chapter>
<chapter id="_solution_components">
<title>Solution Components</title>
<section id="_facility">
<title>Facility</title>
<simpara>While beyond the scope of this document, the heating, ventilation, air conditioning (HVAC) requirements of hosting such a private cloud solution should be carefully considered and planned. To aid in determining the power requirements for system deployment, use the <ulink url="https://h20195.www2.hpe.com/v2/GetPDF.aspx/4AA6-2925ENW.pdf">HPE Power Advisor</ulink> as either an on-line version or with a downloadable application (both available in the Resources section of this document). Using this tool, you can plan the needs for your solution and order the correct Power Distribution Unit (PDU) to account for the local power conditions and connections in the final installation location.</simpara>
</section>
<section id="_network">
<title>Network</title>
<simpara>Networking is the technology component likely to require the most advance planning. Requirements for a private cloud instance have a fair amount of network complexity, especially when integrated with an existing IT infrastructure. For the physical level, using pairs of HPE FlexFabric Switch Series devices as top-of-rack (ToR) switches allows all servers, each having multiple 10GbE, or higher speed, NIC ports, to form a link aggregation group (LAG) across the ports with at least one NIC port on each switch in the stack. When using network interface bonding on the resource nodes, the LAG ideally offers switch redundancy within the rack and enables high availability throughout the infrastructure.</simpara>
<simpara>For this basic deployment guide, a single 10GbE switch is used, having all resource nodes 10GbE NIC ports connected here, but could easily be expanded to the dual ToR configuration at a later date. To address management functions, the iLO, out-of-band interface can be connected to the same or another network switch infrastructure, but are fundamentally required to be accessible for the deployment.</simpara>
<simpara>The following considerations for the network switching configuration should be attended to:</simpara>
<itemizedlist>
<listitem>
<simpara>
Configure 802.3ad for system port bonding to get the maximum performance of bonded network interfaces
</simpara>
</listitem>
<listitem>
<simpara>
Ensure that all similar switching devices are consistent and up-to-date with regard to firmware versions to reduce potential troubleshooting issues later.
</simpara>
</listitem>
</itemizedlist>
<tip><simpara>Meticulous care of the network wiring from the various resource nodes and switches makes troubleshooting much easier. Where possible, also label connections and stick to consistent patterns of port/placement of connections.</simpara></tip>
</section>
<section id="_computing">
<title>Computing</title>
<simpara>One of the benefits of a private cloud implementation is that HPE industry-standard servers can fulfill each of the resource node&#8217;s computational needs. To reduce the time spent on hardware specification for an initial private cloud implementation, the hardware should be general purpose and allow for a wide range of configuration options. The industry leading HPE ProLiant rack mount servers with their high performance, multitude of network options and low energy consumption characteristics are ideal virtualization and storage nodes for a private cloud deployment.</simpara>
<simpara>For this the implementation, HPE ProLiant DL360 Gen9 servers were utilized for all node roles. The main distinction is higher end specifications for the compute node, having more CPU cores and higher amounts of RAM, to host the required workloads.</simpara>
<simpara>The following considerations for the system platforms should be attended to:</simpara>
<note><simpara>Any <ulink url="https://www.suse.com/yessearch/">SUSE YES</ulink> certified HPE platform, like the HPE ProLiant DL360 Gen9, can be used for the physical nodes of this deployment, as long as the certification refers to the major version of the underlying SUSE operating system required by HPE Helion OpenStack.</simpara></note>
<itemizedlist>
<listitem>
<simpara>
Ensure that all similar system devices are consistent and up-to-date with regard to BIOS/uEFI/device firmware versions to reduce potential troubleshooting issues later
</simpara>
</listitem>
<listitem>
<simpara>
Reset the BIOS setup configuration to the default setting to have a known baseline configuration to provide consistency.
</simpara>
</listitem>
<listitem>
<simpara>
Ensure, for resource nodes being targeted as hypervisor nodes, that virtualization features are enabled.
</simpara>
</listitem>
<listitem>
<simpara>
If possible, setup RAID1 mirroring on the storage controller across a pair of drives for the operating system installation
</simpara>
</listitem>
</itemizedlist>
<tip><simpara>HPE OneView can be setup with Server Profile Templates to apply to the various node roles and consistently deliver platform systems into a known state.</simpara></tip>
</section>
<section id="_storage">
<title>Storage</title>
<simpara>Since various OpenStack services have differing storage access needs&#8201;&#8212;&#8201;object for workload images or content, block for persistent data volumes, and file for shared applications and data&#8201;&#8212;&#8201;the most popular approach is to utilize a Ceph-based storage cluster. By integrating such a solution, like SUSE Enterprise Storage, all of these access modes can be satisfied in a resilient, highly-available and scalable fashion across all the resource nodes, services and roles. Since this is an external resource, it can be managed distinctly and grown as needed even with tiered performance levels yet still comply with the multi-tenancy benefits of OpenStack.</simpara>
<simpara>Each of the resource nodes is also expected to have some local, direct-attach storage, which is predominantly used for the node&#8217;s operating system. For this deployment, a pair of disk drives, configured as a RAID1 volume for the operating system helps provide fewer points of failure. This document includes integration aspects of using SUSE Enterprise Storage for cross-function, cross-node shared storage of which there are multiple reference architectures exist for HPE-base solutions.</simpara>
<important><simpara>FixMe : ptr to SES RAs</simpara></important>
</section>
<section id="_software">
<title>Software</title>
<simpara>HPE Helion OpenStack provides an easy to deploy and manage heterogeneous cloud infrastructure for provisioning your development, test and production workloads in a way that is supportable, compliant and secure. With a focus on ease of deployment, the solution also provides a wide choice of hypervisors, one of the broadest range of hardware certification and the ability monitor, manage and optimize your private cloud environment. HPE Helion OpenStack provides the enterprise-grade implementation of OpenStack components abstracts the network, computing, and storage resources. Underlying these OpenStack services is an enterprise-grade distribution of Linux, SUSE Linux Enterprise Server, that provides a stable, secure and performant foundation.</simpara>
<note><simpara>Information on the OpenStack version and projects or features included can be found in the <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8">Planning an Installation with Cloud Lifecycle Manager Guide</ulink></simpara></note>
<simpara>HPE Helion OpenStack enables organizations to set-up and manage their own private clouds and comprises the following components:</simpara>
<variablelist>
<varlistentry>
<term>
Cloud Lifecycle Management (CLM) Deployment Server
</term>
<listitem>
<simpara>
sets up the cloud and configures and provisions the remaining resource nodes and roles. It provides the services and tools needed to quickly and easily deploy all the resource nodes in your private cloud instance. This is implemented on a Deployer Node which can be a physical server, a virtual machine or simply a service on one of the OpenStack Control Nodes. Either a web interface or command-line interface is used during the installation process.
</simpara>
<itemizedlist>
<listitem>
<simpara>
For provisioning and configuration management, technology based upon Ansible is used for repeatable deployment of the remaining software components to the resource nodes
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
<tip><simpara>This server role optionally integrates with HPE OneView for node enumeration and discovery.</simpara></tip>
<variablelist>
<varlistentry>
<term>
Control Node
</term>
<listitem>
<simpara>
hosts the cloud’s self-service portal, providing an image repository and other core OpenStack services. They also automatically track resource state within the Network, Compute and Storage nodes, evaluating available capacity for scheduling and deploying workloads. These functions are delivered in an active-active, high-availability configuration and run on SUSE Linux Enterprise Server.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
Compute Nodes
</term>
<listitem>
<simpara>
are the physical servers, typically running SUSE Linux Enterprise Server with the KVM hypervisor to host virtual machine workloads, optionally integrate with VMware vCenter to host ESXi workloads, or host bare-metal workloads leveraging OpenStack Ironic.  HPE Helion OpenStack also supports Red Hat Enterprise Linux KVM compute nodes when purchased and supported through HPE.
</simpara>
</listitem>
</varlistentry>
</variablelist>
<note><simpara>Information on the supported hypervisors can be found in the <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8">Planning an Installation with Cloud Lifecycle Manager Guide</ulink></simpara></note>
<variablelist>
<varlistentry>
<term>
Storage Nodes
</term>
<listitem>
<simpara>
are the physical servers used to host object storage using Swift or for this implementation an external SUSE Enterprise Storage cluster, based upon Ceph, to deliver object, block and file access methods.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
Miscellaneous Services
</term>
<listitem>
<simpara>
a cloud administrator also leverages the following services:
</simpara>
<itemizedlist>
<listitem>
<simpara>
Network Time Protocol (NTP) to keep system clocks in sync and provide consistent timestamps for all resource nodes, logs and actions
</simpara>
</listitem>
<listitem>
<simpara>
Domain Name Service (DNS) to provide mapping of hostname to IP from both external sources for the workloads public visibility and internally for the resource nodes within the private cloud.
</simpara>
</listitem>
<listitem>
<simpara>
Software repositories of all of the needed components to initially install the resource nodes, plus allow updates to be applied to the nodes over time
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
<simpara>As preparation, obtain the following software media and documentation artifacts:</simpara>
<itemizedlist>
<listitem>
<simpara>
From the <ulink url="https://download.suse.com/Download?buildid=I0hh1NnYe7c~">HPE Helion OpenStack</ulink> site download the HPE Helion OpenStack install media (DVD1)
</simpara>
</listitem>
<listitem>
<simpara>
From the main <ulink url="https://download.suse.com">SUSE Downloads</ulink> site, download
</simpara>
<itemizedlist>
<listitem>
<simpara>
the SUSE Linux Enterprise Server 12-SP3 (DVD1) operating system install media.
</simpara>
</listitem>
<listitem>
<simpara>
the SUSE Linux Enterprise Server Software Development Kit (SDK) 12-SP3 (DVD1).
</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>
Utilize either trial or purchased subscriptions for the all the resource nodes to ensure access to support and software updates. The bill of materials section in the appendices outlines the type and quantity of subscriptions needed.
</simpara>
</listitem>
<listitem>
<simpara>
In addition, obtain and preview the <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8/">HPE Helion OpenStack</ulink> documentation, focusing on the:
</simpara>
<itemizedlist>
<listitem>
<simpara>
Planning an Installation with Cloud Lifecycle Manager
</simpara>
</listitem>
<listitem>
<simpara>
Installing with Cloud Lifecycle Manager
</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</section>
</chapter>
<chapter id="_solution_details">
<title>Solution Details</title>
<simpara>This document focuses on a new HPE Helion OpenStack deployment which can be scaled over time, utilizing an Entry-scale KVM configuration with the core OpenStack services. This input model template is included in HPE Helion OpenStack and described in the respective section of the <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8">Planning an Installation with Cloud Lifecycle Manager Guide</ulink>. It serves as a great starting point and includes recommended minimum values for node count and resources.</simpara>
<figure id="img-DeployLV"><title>Deployment Logical View</title>
<mediaobject>
  <imageobject>
  <imagedata fileref="HPE_Helion_OpenStack-RC-DeploymentLV.png"/>
  </imageobject>
  <textobject><phrase>Deployment-Logical-View</phrase></textobject>
</mediaobject>
</figure>
<section id="_deployment_flow">
<title>Deployment Flow</title>
<simpara>This section is meant as a companion guide to the official network, system and software product deployment documentation, citing specific settings as needed for this reference implementation. Default settings are assumed to be in use unless otherwise cited to accomplish the respective best practices and design decisions herein.</simpara>
<simpara>Given the very detail information contained in the <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8">Installing with Cloud Lifecycle Manager</ulink> Guide, only the following additional, incremental and modifications are described below:</simpara>
<itemizedlist>
<listitem>
<simpara>
Pre-Installation Checklist
</simpara>
<itemizedlist>
<listitem>
<simpara>
The network topology shown in the following figure was utilized
</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<important><simpara>FixMe : network topology diagram</simpara></important>
<itemizedlist>
<listitem>
<simpara>
Installing the Cloud Lifecycle Manager server
</simpara>
<itemizedlist>
<listitem>
<simpara>
In this implementation, an existing <ulink url="https://www.suse.com/documentation/sles-12/index.html">Subscription Management Tool</ulink> (SMT) server was available in the environment and already mirrored all the necessary product and update channels.
</simpara>
</listitem>
<listitem>
<simpara>
No SAN nor FibreChannel was utilized in this deployment, since all resource nodes had sufficient storage and an external SUSE Enterprise Storage cluster was to be integrated with the OpenStack services.
</simpara>
</listitem>
</itemizedlist>
</listitem>
<listitem>
<simpara>
Cloud Installation
</simpara>
<itemizedlist>
<listitem>
<simpara>
To simplify the process, the Install UI approach was utilized for the initial deployment. As noted in the HPE Helion OpenStack documentation, you must gather some physical hardware details for inputs to the web-interface forms as you step through the various stages:
</simpara>
<itemizedlist>
<listitem>
<simpara>
Welcome
</simpara>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
</listitem>
</itemizedlist>
<figure id="img-Welcome"><title>CLM Welcome</title>
<mediaobject>
  <imageobject>
  <imagedata fileref="Welcome.png"/>
  </imageobject>
  <textobject><phrase>CLM-Welcome</phrase></textobject>
</mediaobject>
</figure>
<itemizedlist>
<listitem>
<simpara>
Choose an OpenStack Cloud Model - Entry Scale KVM
</simpara>
</listitem>
</itemizedlist>
<figure id="img-Model"><title>CLM Choose Model</title>
<mediaobject>
  <imageobject>
  <imagedata fileref="Model.png"/>
  </imageobject>
  <textobject><phrase>CLM-Model</phrase></textobject>
</mediaobject>
</figure>
<itemizedlist>
<listitem>
<simpara>
Cloud Model to Deploy - 3 Controller Nodes, 1 Compute Nodes
</simpara>
</listitem>
</itemizedlist>
<figure id="img-Model-Deploy"><title>CLM Choose Model Deploy</title>
<mediaobject>
  <imageobject>
  <imagedata fileref="Model-Deploy.png"/>
  </imageobject>
  <textobject><phrase>CLM-Model-Deploy</phrase></textobject>
</mediaobject>
</figure>
<itemizedlist>
<listitem>
<simpara>
Add Servers and Assign Server Roles, edit each node&#8217;s attributes/details
</simpara>
</listitem>
</itemizedlist>
<figure id="img-Role-Details"><title>CLM Role Details</title>
<mediaobject>
  <imageobject>
  <imagedata fileref="Role-Details.png"/>
  </imageobject>
  <textobject><phrase>CLM-Role-Details</phrase></textobject>
</mediaobject>
</figure>
<itemizedlist>
<listitem>
<simpara>
Server Installation
</simpara>
</listitem>
</itemizedlist>
<figure id="img-OSInstall"><title>CLM OS Install</title>
<mediaobject>
  <imageobject>
  <imagedata fileref="OSInstall.png"/>
  </imageobject>
  <textobject><phrase>CLM-OSInstall</phrase></textobject>
</mediaobject>
</figure>
<note><simpara>Given the small number of initial nodes in this deployment, each was installed with the SUSE Linux Enterprise Server operating system using the ISO media and the HPE iLO virtual media methodology instead of the PXE/Cobbler approach. An autoYaST file, obtained from the first resource node install via "yast clone-system" was leveraged for the other nodes as an answer file for consistent operating system deployments. So this step was effectively skipped.
<emphasis role="strong">*</emphasis> Server Role Summary - Manage Cloud Settings for NIC Mappings, Networks, Disk Models, and Interface Models</simpara></note>
<figure id="img-Roles-Cloud-Settings"><title>CLM Roles Cloud Settings</title>
<mediaobject>
  <imageobject>
  <imagedata fileref="Roles-Cloud-Settings.png"/>
  </imageobject>
  <textobject><phrase>CLM-Roles-Cloud-Settings</phrase></textobject>
</mediaobject>
</figure>
<itemizedlist>
<listitem>
<simpara>
Review Configuration Files - Adjust as needed, then Validate and Deploy
</simpara>
</listitem>
</itemizedlist>
<figure id="img-Deploy"><title>CLM Deploy</title>
<mediaobject>
  <imageobject>
  <imagedata fileref="Deploy.png"/>
  </imageobject>
  <textobject><phrase>CLM-Deploy</phrase></textobject>
</mediaobject>
</figure>
<simpara>When these steps complete successfully, the next screen will provide links to both the OpenStack Horizon and Ops Console user interfaces. If issues arise at any of the above steps, you can simply use the "Back" button to address them and continue the process until completed.</simpara>
<simpara>To complete the integration with Ceph-based, SUSE Enterprise Storage, refer to <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8">Installing with Cloud Lifecycle Manager Guide</ulink>.</simpara>
</section>
<section id="_additional_considerations">
<title>Additional Considerations</title>
<simpara>As a verification of your HPE Helion OpenStack deployment, it is common to utilize Tempest to ensure the APIs are present and functioning as expected (refer to the <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8">Installing with Cloud Lifecycle Manager Guide</ulink>). Individual, interactive user-interface tasks are also detailed in that guide as well.</simpara>
<simpara>While this minimal deployment does provide most of the OpenStack functionality, you can scale the cloud instance as needed to meet your demands (refer to the <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8">Planning an Installation with Cloud Lifecycle Manager Guide</ulink>). As a reminder, multiple input model templates are available in HPE Helion OpenStack, which can be used as a starting point or just to leverage approaches for your specific private cloud needs. In addition, there are also comprehensive documents in this same location for:
* Operations and Ops Console Guides
* Security Guide
* User Guide</simpara>
<simpara>If one had an existing, but earlier verion of HPE Helion OpenStack instance, instructions are available to upgrade or migrate to this release. These process details can be found at <ulink url="http://hos.suse.com/">HPE Helion OpenStack</ulink> in the form of specific tasks.</simpara>
</section>
</chapter>
<chapter id="_conclusions">
<title>Conclusions</title>
<simpara>After understanding and working through the steps described in this document, you should have a working cloud that is scalable through the addition of even more compute and storage nodes, as needed. HPE Helion OpenStack OpenStack Cloud is a complete suite of software and may be configured in many different ways. This solution architecture provides a baseline for a private cloud implementation with highly available control plane services, using HPE FlexFabric networking and ProLiant rack servers and can serve as a functional environment for many workloads. HPE ProLiant DL360 Gen9 series hardware is an excellent platform for implementation of OpenStack software. It provides powerful, dense compute, and storage capabilities via the servers we’ve selected for this solution architecture. And the ProLiant iLO management capability is indispensable in managing a cloud cluster of this kind.</simpara>
</chapter>
<chapter id="_resources_and_additional_links">
<title>Resources and additional links</title>
<important><simpara>FixMe : BOM tables</simpara></important>
<variablelist>
<varlistentry>
<term>
NWSwitches
</term>
<term>
HPE ProLiant
</term>
<term>
HPE Helion OpenStack
</term>
<listitem>
<itemizedlist>
<listitem>
<simpara>
Product Documentation - <ulink url="https://www.suse.com/documentation/hpe-helion-openstack-8/">https://www.suse.com/documentation/hpe-helion-openstack-8/</ulink>
</simpara>
</listitem>
<listitem>
<simpara>
Migration Documentation - <ulink url="http://hos.suse.com/">http://hos.suse.com/</ulink>
</simpara>
</listitem>
</itemizedlist>
</listitem>
</varlistentry>
</variablelist>
</chapter>
</book>
